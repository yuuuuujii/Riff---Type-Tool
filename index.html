<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Riff | TypeTool</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <style>
        /* åŸºç¡€æ ·å¼ */
        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; transition: background-color 0.5s ease, color 0.5s ease;
        }
        body {
            background-color: #FFFFFF; display: flex; flex-direction: column;
            justify-content: space-between; --text-color: #000000; color: #000000;
        }
        body.dark-mode {
            background-color: #000000 !important; --text-color: #FFFFFF; color: #FFFFFF;
        }

        /* å¯¼èˆªæ  */
        .global-nav {
            position: fixed; top: 0; left: 0; width: 100%; z-index: 10000;
            padding: 20px; display: flex; gap: 10px; justify-content: flex-end; pointer-events: none;
        }
        .global-nav a, .theme-btn { pointer-events: auto; }
        .theme-btn {
            width: 38px; height: 38px; border-radius: 50%;
            border: 1px solid #000000; background: linear-gradient(to right, #FFFFFF 50%, #000000 50%);
            cursor: pointer; transition: transform 0.2s ease, background 0.5s ease;
        }
        body.dark-mode .theme-btn { background: linear-gradient(to right, #000000 50%, #FFFFFF 50%); border-color: #FFFFFF; }

        /* å†…å®¹å¸ƒå±€ */
        .description-section {
            padding-top: 20px; padding-left: 20px; padding-right: 20px;
            width: 100%; max-width: 100%; position: relative; z-index: 2;
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 42px; 
        }

        /* 1. è¯´æ˜æ–‡å­— (Medium å­—ä½“) */
        .description-text {
            font-family: 'IBM Plex Mono Medium', monospace; 
            font-weight: 500;
            color: #000000; 
            font-size: 12px !important; 
            line-height: 18px !important; 
            margin: 0; 
            text-align: left;
        }
        
        body.dark-mode .description-text {
            color: #FFFFFF;
        }

        /* 2. ç½²åæ–‡å­— (Medium å­—ä½“) */
        .credit-text {
            font-family: 'IBM Plex Mono Medium', monospace !important;
            font-weight: 500 !important;
            font-size: 12px !important; 
            line-height: 18px !important;
            color: #000000 !important; 
            margin-top: 16px !important; 
            display: block;
        }
        
        body.dark-mode .credit-text {
            color: #FFFFFF !important;
        }

        /* 3. å¼ºåˆ¶å†…éƒ¨æ ‡ç­¾ç»§æ‰¿å­—ä½“æ ·å¼ */
        .credit-text span, 
        .credit-text a {
            font-family: inherit !important; 
            font-size: inherit !important;   
            font-weight: inherit !important; 
            color: inherit !important; 
        }

        .credit-link {
            text-decoration: none;
            border-bottom: 1.2px solid #000000;
        }
        body.dark-mode .credit-link {
            border-bottom-color: #FFFFFF;
        }
        .credit-link:hover { color: #4DDE39 !important; border-bottom-color: #4DDE39; }
        
        /* åº•éƒ¨è§†é¢‘åŒºåŸŸ */
        .visual-grid {
            display: flex; width: 100%; height: 70vh; align-items: flex-end;
            position: absolute; bottom: 0; z-index: 1; overflow: hidden; 
        }
       .grid-track {
            display: flex; height: 100%; width: max-content; gap: 25px; 
            will-change: transform; transform: translate3d(0, 0, 0); 
            backface-visibility: hidden; perspective: 1000px;
        }
        .video-block { height: 100%; flex: 0 0 auto; width: auto; }
        .video-block video { height: 100%; width: auto; display: block; border-radius: 20px; }
        
        /* æ–¹å½¢å®¹å™¨å±…ä¸­ä¿®å¤ (å¯¹ç¬¬4ä¸ª blue.mp4 æœ‰æ•ˆ) */
        .square-block {
            height: 100%; 
            aspect-ratio: 1 / 1; 
            background-color: #000000; 
            flex: 0 0 auto; 
            border-radius: 20px; 
            overflow: hidden; 
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .scroll-btn {
            position: absolute; right: 20px; bottom: 50%; transform: translateY(50%);
            width: 50px; height: 50px; border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.3); backdrop-filter: blur(8px);
            border: 1px solid rgba(0, 0, 0, 0.1); cursor: pointer; z-index: 10;
            display: flex; align-items: center; justify-content: center;
        }
        .arrow-icon {
            width: 16px; height: 16px; border-top: 2px solid #000; border-right: 2px solid #000;
            transform: rotate(45deg); margin-left: -4px;
        }
        body.dark-mode .arrow-icon { border-color: #FFFFFF; }
        body.dark-mode .scroll-btn { background-color: rgba(255, 255, 255, 0.15); border-color: rgba(255, 255, 255, 0.3); }

        /* ç¬¬3ä¸ªè§†é¢‘ä¿®æ­£ (ä¿æŒé€æ˜) */
        .grid-track > :nth-child(3) { display: block !important; flex: 0 0 auto !important; background-color: transparent; }
        .grid-track > :nth-child(3) video { height: 100% !important; width: auto !important; transform: none !important; border-radius: 20px !important; }
        
        #preset-panel { border-radius: 30px !important; }
        @media (max-width: 900px) {
            .description-section { grid-template-columns: 1fr; gap: 20px; padding-top: 80px; }
            html, body { overflow-y: auto; height: auto; }
            .visual-grid { position: relative; height: 40vh; } 
        }

        /* ğŸ‘‡ğŸ‘‡ğŸ‘‡ èƒŒæ™¯ç²’å­ç”»å¸ƒ & SVG å®¹å™¨ ğŸ‘‡ğŸ‘‡ğŸ‘‡ */
        #riff-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 9000; /* é¡¶å±‚è¦†ç›– */
            pointer-events: none; /* ç©¿é€ç‚¹å‡» */
            mix-blend-mode: difference; /* å·®å€¼æ•ˆæœ */
        }

        #source-svg-container {
            position: absolute; width: 0; height: 0; overflow: hidden; opacity: 0; pointer-events: none;
        }
    </style>
</head>
<body>
    <canvas id="riff-canvas"></canvas>

    <div id="source-svg-container">
        <svg id="_å›¾å±‚_1" data-name="å›¾å±‚ 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1130.63 554.39">
          <circle cx="4.74" cy="25.55" r="4.74"/>
          <circle cx="99.07" cy="4.74" r="4.74"/>
          <circle cx="168.93" cy="40.63" r="4.74"/>
          <circle cx="194.74" cy="154.65" r="4.74"/>
          <circle cx="168.95" cy="264.29" r="4.74"/>
          <circle cx="99.36" cy="300.98" r="4.74"/>
          <circle cx="110.19" cy="393.47" r="4.74"/>
          <circle cx="168.38" cy="423.55" r="4.74"/>
          <circle cx="190.83" cy="521.95" r="4.74"/>
          <circle cx="250.01" cy="549.64" r="4.74"/>
          <circle cx="4.74" cy="153.75" r="4.74"/>
          <circle cx="4.74" cy="281.66" r="4.74"/>
          <circle cx="4.74" cy="407.19" r="4.74"/>
          <circle cx="4.74" cy="535.81" r="4.74"/>
          <circle cx="390.39" cy="25.55" r="4.74"/>
          <circle cx="390.39" cy="153.75" r="4.74"/>
          <circle cx="390.39" cy="281.66" r="4.74"/>
          <circle cx="390.39" cy="407.19" r="4.74"/>
          <circle cx="390.39" cy="535.81" r="4.74"/>
          <circle cx="596.96" cy="25.55" r="4.74"/>
          <circle cx="596.96" cy="153.75" r="4.74"/>
          <circle cx="596.96" cy="281.66" r="4.74"/>
          <circle cx="691.21" cy="25.55" r="4.74"/>
          <circle cx="691.21" cy="281.66" r="4.74"/>
          <circle cx="772.18" cy="25.55" r="4.74"/>
          <circle cx="772.18" cy="281.66" r="4.74"/>
          <circle cx="596.96" cy="407.19" r="4.74"/>
          <circle cx="596.96" cy="535.81" r="4.74"/>
          <circle cx="950.67" cy="25.55" r="4.74"/>
          <circle cx="950.67" cy="153.75" r="4.74"/>
          <circle cx="950.67" cy="281.66" r="4.74"/>
          <circle cx="1044.92" cy="25.55" r="4.74"/>
          <circle cx="1044.92" cy="281.66" r="4.74"/>
          <circle cx="1125.89" cy="25.55" r="4.74"/>
          <circle cx="1125.89" cy="281.66" r="4.74"/>
          <circle cx="950.67" cy="407.19" r="4.74"/>
          <circle cx="950.67" cy="535.81" r="4.74"/>
        </svg>
    </div>

    <nav class="global-nav">
        <a href="index.html" class="active">ABOUT</a> 
        <a href="tool.html">TYPETOOL</a>
        <button id="themeToggle" class="theme-btn" title="Toggle Background Color"></button>
    </nav>

    <section class="description-section">
        <div>
            <p class="description-text">
                â€œRiffâ€ is a variable typetool based on continuous change. Emerging from a single underlying structure, it moves, stretches, and folds across multiple dimensionsâ€”like musical improvisation: repetitive, yet never exactly the same. Rather than forming fixed states, the type exists in constant transition, shaped by ongoing variation. Each adjustment generates new echoes between structure and rhythm, allowing the letters to breathe, flow, and transform over time.
            </p>
            <p class="credit-text">
                <span class="credit-label">Type Tool / Web Design</span> / <a href="https://www.instagram.com/yjjj___" target="_blank" class="credit-link">Yu Ji</a>
            </p>
        </div>
        <div>
            <p class="description-text">
                These shifts unfold gradually, revealing subtle differences within repetition and emphasizing process over outcome. Through varying degrees of freedom and subtle color gradients, the same skeletal form is continuously re-explored, producing a wide spectrum of typographic expressions. Form, motion, and color operate together as interdependent parameters, responding to one another in a dynamic system.
            </p>
        </div>
        <div></div>
    </section>

    <section class="visual-grid" id="visualGrid">
        <div class="grid-track" id="gridTrack">
            <div class="video-block"><video src="3_3.mp4" autoplay loop muted playsinline preload="auto"></video></div>
            <div class="video-block"><video src="2_33.mp4" autoplay loop muted playsinline preload="auto"></video></div>
            <div class="video-block"><video src="555.MP4" autoplay loop muted playsinline preload="auto"></video></div>
            <div class="square-block"><video src="blue.MP4" autoplay loop muted playsinline preload="auto" style="height:100%;width:100%;object-fit:contain;"></video></div>
        </div>
        <button class="scroll-btn" id="scrollBtn"><div class="arrow-icon"></div></button>
    </section>

    <script>
        const themeBtn = document.getElementById('themeToggle');
        themeBtn.addEventListener('click', () => { document.body.classList.toggle('dark-mode'); });
        const scrollBtn = document.getElementById('scrollBtn');
        const gridTrack = document.getElementById('gridTrack');
        const GAP = 32, AUTO_SPEED = 0.8, EASE = 0.05; 
        let singleSetWidth = 0, currentPos = 0, targetPos = 0;

        window.addEventListener('load', () => {
            const items = Array.from(gridTrack.children);
            items.forEach(item => {
                singleSetWidth += item.getBoundingClientRect().width + GAP;
                gridTrack.appendChild(item.cloneNode(true));
            });
            render();
        });

        function render() {
            targetPos += AUTO_SPEED;
            currentPos += (targetPos - currentPos) * EASE;
            if (currentPos >= singleSetWidth) { currentPos -= singleSetWidth; targetPos -= singleSetWidth; }
            gridTrack.style.transform = `translate3d(-${currentPos}px, 0, 0)`;
            requestAnimationFrame(render);
        }
        scrollBtn.addEventListener('click', () => { targetPos += 500; });
    </script>
    
    <script>
    // ==========================================
    // Riff ç²’å­ç‰¹æ•ˆ (é£å…¥åŠ¨ç”» + äº¤äº’æ‚¬åœ + 0.05 æŒ¤å‹)
    // ==========================================
    (function() {
        const canvas = document.getElementById('riff-canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];
        
        // ğŸš€ æ ¸å¿ƒæ§åˆ¶å˜é‡
        let currentRatio = 0.05; // åˆå§‹çŠ¶æ€ä¸º 0.05
        let targetRatio = 0.05;  // ç›®æ ‡çŠ¶æ€ä¹Ÿæ˜¯ 0.05
        
        // å¸¸é‡è®¾ç½®
        const OFFSET_Y = 20;    // è·ç¦»é¡¶éƒ¨çš„è·ç¦» (px)
        const LERP_SPEED = 0.1; // äº¤äº’åŠ¨ç”»å¹³æ»‘åº¦

        class Particle {
            constructor(finalX, relativeY, r) {
                this.finalX = finalX;       // æœ€ç»ˆ X ç›®æ ‡
                this.relativeY = relativeY; // æœ€ç»ˆ Y ç»“æ„
                this.size = r;

                // ğŸš€ é£å…¥åŠ¨ç”»ï¼šåˆå§‹ä½ç½®éšæœº
                this.x = Math.random() * window.innerWidth;
                this.y = Math.random() * window.innerHeight; 

                // å…¥åœºé£è¡Œçš„é€Ÿåº¦ (æ•°å€¼è¶Šå°è¶Šæ…¢ä¸”å¹³æ»‘)
                this.ease = 0.05; 
            }

            update() {
                // 1. è®¡ç®—è¿™ä¸€å¸§çš„ç›®æ ‡ä½ç½® (Target Position)
                // X çš„ç›®æ ‡å°±æ˜¯ SVG é‡Œçš„ä½ç½®
                const destX = this.finalX;
                
                // Y çš„ç›®æ ‡å—é¼ æ ‡æ‚¬åœ (currentRatio) å½±å“ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒèƒ½åŠ¨
                const destY = this.relativeY * currentRatio + OFFSET_Y;

                // 2. ç¼“åŠ¨é£å‘ç›®æ ‡ (Current Position -> Target Position)
                // è¿™è¡Œä»£ç åŒæ—¶è´Ÿè´£â€œå…¥åœºåŠ¨ç”»â€å’Œâ€œæ‚¬åœåŠ¨ç”»â€
                this.x += (destX - this.x) * this.ease;
                this.y += (destY - this.y) * this.ease;
            }

            draw() {
                ctx.fillStyle = '#FFFFFF'; 
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            particles = [];

            const container = document.getElementById('source-svg-container');
            const svgElement = container.querySelector('svg');
            if (!svgElement) return;

            let svgW = 1920, svgH = 1080;
            if (svgElement.viewBox.baseVal && svgElement.viewBox.baseVal.width > 0) {
                svgW = svgElement.viewBox.baseVal.width;
                svgH = svgElement.viewBox.baseVal.height;
            } else if (svgElement.width.baseVal && svgElement.width.baseVal.value > 0) {
                svgW = svgElement.width.baseVal.value;
                svgH = svgElement.height.baseVal.value;
            }

            // 1. æ°´å¹³ç¼©æ”¾ï¼šå®½åº¦å å±å¹• 98%
            const scaleX = (width / svgW) * 0.98;
            const offsetX = (width - svgW * scaleX) / 2;
            
            const shapes = svgElement.querySelectorAll('circle, rect, path, ellipse, polygon');

            shapes.forEach(shape => {
                const bbox = shape.getBBox();
                const svgX = bbox.x + bbox.width / 2;
                const svgY = bbox.y + bbox.height / 2;
                
                // è®¡ç®—ç›®æ ‡ X åæ ‡
                const finalX = svgX * scaleX + offsetX;
                
                // è®¡ç®—ç›¸å¯¹ Y åæ ‡ (åŸºå‡†é«˜åº¦)
                const relativeY = svgY * scaleX; 
                
                // ç²’å­å¤§å°
                let screenSize = (bbox.width / 2) * scaleX * 0.6;
                screenSize = Math.max(1.5, screenSize); 

                particles.push(new Particle(finalX, relativeY, screenSize));
            });
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            
            // æ›´æ–°æ‚¬åœæ¯”ä¾‹ (è®© currentRatio è¿½èµ¶ targetRatio)
            currentRatio += (targetRatio - currentRatio) * LERP_SPEED;

            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animate);
        }

        // ğŸ–±ï¸ é¼ æ ‡ç›‘å¬
        window.addEventListener('mousemove', (e) => {
            // å¦‚æœé¼ æ ‡åœ¨å±å¹•é«˜åº¦çš„å‰ 35% åŒºåŸŸ
            if (e.clientY < window.innerHeight * 0.35) {
                targetRatio = 1.0; // å±•å¼€
            } else {
                targetRatio = 0.05; // æ”¶ç¼©
            }
        });

        window.addEventListener('resize', init);

        setTimeout(() => {
            init();
            animate();
        }, 100);
    })();
    </script>
</body>
</html>